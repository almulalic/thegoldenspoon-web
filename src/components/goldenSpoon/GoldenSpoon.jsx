import React, { useState, useEffect } from "react";
import "./GoldenSpoon.scss";
import { Stack } from "../../elements/stack/Stack";
import statistics from "../../api/statistics";
import { ProgressSpinner } from "primereact/progressspinner";

export const GoldenSpoon = () => {
  const [goldenSpoonData, setGoldenSpoonData] = useState();
  const [isLoadingGoldenSpoonData, setLoadingGoldenSpoonData] = useState(false);

  const fetchGoldenSpoonProgress = () => {
    statistics
      .fetchGoldenSpoonProgress()
      .then((goldenSpoonProgressResponse) => {
        setGoldenSpoonData(goldenSpoonProgressResponse.data);
        console.log(goldenSpoonProgressResponse);
        setLoadingGoldenSpoonData(false);
      })
      .catch((err) => {
        console.log(err);
        setLoadingGoldenSpoonData(false);
      });
  };

  useEffect(() => {
    fetchGoldenSpoonProgress();
    setLoadingGoldenSpoonData(true);
  }, []);

  return (
    <div className="GoldenSpoon-Container">
      {isLoadingGoldenSpoonData ? (
        <Stack alignment="center">
          <ProgressSpinner />
        </Stack>
      ) : (
        <div>
          <div className="GoldenSpoon-Info">
            <Stack alignment="center" vertical spacing="none">
              <p>The golden spoon progress</p>
              <p>
                {goldenSpoonData?.visited} / 386 ( {goldenSpoonData?.precent}% )
              </p>
            </Stack>
          </div>
          <Stack
            alignment="center"
            distribution="center"
            vertical
            spacing="none"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 0 174.07 839.93"
              className="GoldenSpoon-Svg"
            >
              <g id="Layer_2" data-name="Layer 2">
                <g
                  id="Layer_1-2"
                  data-name="Layer 1"
                  transform="scale(0.999999)"
                >
                  <path
                    fill="black"
                    d="M82.57,838.5c2.8-1.9,7.6-11.5,7.3-14.6-.1-1.3-.1-3.4-.1-4.6l.2-2.2,4.7,2.5c4.1,2.2,5.7,2.5,10.9,2.1,11.1-.8,20.2-7.4,25.9-18.8,2.2-4.2,2.8-7.1,3.2-14.9,1-17.4-3.6-33.5-18-63.1-10.5-21.5-12.1-26.3-12.1-35.9,0-7.8.5-9.5,6.4-19.5,3.8-6.4,3.9-11.3.5-15.3l-2.6-3.1,3.6-1.2c2.5-.9,3.5-1.9,3.5-3.4a4.37,4.37,0,0,1,2.1-3.3c1.7-1.1,1.8-1.6.8-2.8s-.9-1.8-.1-2.6c1.5-1.5,1.5-6.1.1-7.5-.7-.7-.7-1.3-.1-1.7,1.4-.9.2-4.6-1.4-4.6-1,0-1.3-.7-.8-2.4.4-1.9.1-2.6-1.8-3.2-3.3-1-4.8-3.5-4.2-7,.4-2.2-.3-4.7-2.4-9-9.4-18.4-11.4-44.5-10.8-139.9.8-120,3.2-141.3,17.6-155,6.4-6.1,7.7-12,3.5-15.9-2.9-2.7-2.9-2.8,6.3-7.6,9.8-5.2,22.5-16.9,28.7-26.4,13.7-20.9,20.7-47.7,20.6-78.6,0-23.6-3.1-41.6-11.7-68.3C160,103,158,96.4,158,95.9c0-2.4-11.6-26.7-18-37.9-9-15.5-13.9-22.5-24.3-34.4C108.17,15,91.37,0,89.17,0c-.5,0-4.6,2.6-9.3,5.9-10.1,7-24.3,20.2-28.4,26.2-1.7,2.4-5.5,8-8.6,12.4-7.2,10.1-19.3,34.2-25.5,50.5-5.9,15.6-12.7,42.5-15.4,60.7-5.1,35.3-.3,66.6,14.3,93.1,7,12.5,19.2,26.7,29.2,33.9,2.7,2,6.2,4.8,7.7,6.2,2.4,2.1,2.6,2.7,1.4,4-3.3,3.6-2.9,6.5,1.3,11.7C66.57,317.4,71,342.8,71,391c0,45.8-3.4,147.7-5.6,165.6-2.7,22.9-4.8,32-9.4,40.7-3.3,6.4-4.1,8.8-3.7,11.4.5,2.8.1,3.8-2.9,6.7-1.9,1.8-3.4,3.6-3.4,4a8.59,8.59,0,0,1-2,2.6,7,7,0,0,0-2,3.9,3.5,3.5,0,0,1-1,2.6c-.6.3-1,1.7-1,3s.4,2.7,1,3,1,1.7,1,3a4.24,4.24,0,0,0,1.1,3.1c.6.3.8,1.5.6,2.6-.4,1.3.2,2.2,1.8,3,3.3,1.5,4,5.3,1.5,8.5-2.8,3.6-2.6,9.2.5,13.4,6.2,8.7,7.9,16.8,5.5,27-1.1,4.7-10.9,25.3-19.9,41.9-8.3,15.3-14,30.9-15.5,42.5-.8,6.5,2.4,22.3,5.5,26.7,6.6,9.7,13,13.8,22.4,14.5,5,.4,6.8.1,11-2.1,5-2.6,7.3-2.1,5.6,1.3-1,2.1.6,8,2.4,8.7.7.3,1.6,2.3,2,4.5s1.5,4.5,2.8,5.4C72,840.4,79.87,840.4,82.57,838.5Z"
                  />
                </g>
                <g id="Layer_1-2" data-name="Layer 1">
                  <path
                    fill="url(#gold-fill)"
                    stroke="#D4AF37	"
                    strokeWidth="1.5px"
                    d="M82.57,838.5c2.8-1.9,7.6-11.5,7.3-14.6-.1-1.3-.1-3.4-.1-4.6l.2-2.2,4.7,2.5c4.1,2.2,5.7,2.5,10.9,2.1,11.1-.8,20.2-7.4,25.9-18.8,2.2-4.2,2.8-7.1,3.2-14.9,1-17.4-3.6-33.5-18-63.1-10.5-21.5-12.1-26.3-12.1-35.9,0-7.8.5-9.5,6.4-19.5,3.8-6.4,3.9-11.3.5-15.3l-2.6-3.1,3.6-1.2c2.5-.9,3.5-1.9,3.5-3.4a4.37,4.37,0,0,1,2.1-3.3c1.7-1.1,1.8-1.6.8-2.8s-.9-1.8-.1-2.6c1.5-1.5,1.5-6.1.1-7.5-.7-.7-.7-1.3-.1-1.7,1.4-.9.2-4.6-1.4-4.6-1,0-1.3-.7-.8-2.4.4-1.9.1-2.6-1.8-3.2-3.3-1-4.8-3.5-4.2-7,.4-2.2-.3-4.7-2.4-9-9.4-18.4-11.4-44.5-10.8-139.9.8-120,3.2-141.3,17.6-155,6.4-6.1,7.7-12,3.5-15.9-2.9-2.7-2.9-2.8,6.3-7.6,9.8-5.2,22.5-16.9,28.7-26.4,13.7-20.9,20.7-47.7,20.6-78.6,0-23.6-3.1-41.6-11.7-68.3C160,103,158,96.4,158,95.9c0-2.4-11.6-26.7-18-37.9-9-15.5-13.9-22.5-24.3-34.4C108.17,15,91.37,0,89.17,0c-.5,0-4.6,2.6-9.3,5.9-10.1,7-24.3,20.2-28.4,26.2-1.7,2.4-5.5,8-8.6,12.4-7.2,10.1-19.3,34.2-25.5,50.5-5.9,15.6-12.7,42.5-15.4,60.7-5.1,35.3-.3,66.6,14.3,93.1,7,12.5,19.2,26.7,29.2,33.9,2.7,2,6.2,4.8,7.7,6.2,2.4,2.1,2.6,2.7,1.4,4-3.3,3.6-2.9,6.5,1.3,11.7C66.57,317.4,71,342.8,71,391c0,45.8-3.4,147.7-5.6,165.6-2.7,22.9-4.8,32-9.4,40.7-3.3,6.4-4.1,8.8-3.7,11.4.5,2.8.1,3.8-2.9,6.7-1.9,1.8-3.4,3.6-3.4,4a8.59,8.59,0,0,1-2,2.6,7,7,0,0,0-2,3.9,3.5,3.5,0,0,1-1,2.6c-.6.3-1,1.7-1,3s.4,2.7,1,3,1,1.7,1,3a4.24,4.24,0,0,0,1.1,3.1c.6.3.8,1.5.6,2.6-.4,1.3.2,2.2,1.8,3,3.3,1.5,4,5.3,1.5,8.5-2.8,3.6-2.6,9.2.5,13.4,6.2,8.7,7.9,16.8,5.5,27-1.1,4.7-10.9,25.3-19.9,41.9-8.3,15.3-14,30.9-15.5,42.5-.8,6.5,2.4,22.3,5.5,26.7,6.6,9.7,13,13.8,22.4,14.5,5,.4,6.8.1,11-2.1,5-2.6,7.3-2.1,5.6,1.3-1,2.1.6,8,2.4,8.7.7.3,1.6,2.3,2,4.5s1.5,4.5,2.8,5.4C72,840.4,79.87,840.4,82.57,838.5Z"
                  />
                </g>

                <defs>
                  <linearGradient
                    id="gold-fill"
                    x1="0.5"
                    y1="1"
                    x2="0.5"
                    y2={1 - goldenSpoonData?.precent / 100}
                  >
                    <stop offset="100%" stop-opacity="1" stop-color="#D4AF37	">
                      <animate
                        attributeName="offset"
                        values="0;1"
                        repeatCount="1"
                        dur="2s"
                        begin="0s"
                      />
                    </stop>
                    <stop offset="100%" stop-opacity="0" stop-color="#D4AF37	">
                      <animate
                        attributeName="offset"
                        values="0;1"
                        repeatCount="1"
                        dur="2s"
                        begin="0s"
                      />
                    </stop>
                  </linearGradient>
                </defs>
              </g>
            </svg>
          </Stack>
        </div>
      )}
    </div>
  );
};
